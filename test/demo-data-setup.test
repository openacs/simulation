if { [catch {

    # Source Tcl libraries
    set script_dir [file dirname [info script]]
    source "${script_dir}/../../../etc/install/tcl/test-procs.tcl"
    source "${script_dir}/simulation-test-procs.tcl"
    source "${script_dir}/demo-data.tcl"

    ::twt::simulation::setup::users_and_groups

    ::twt::simulation::setup::citybuild_objects

    ::twt::simulation::setup::elementary_private_law_template   
    ::twt::simulation::setup::legislative_drafting_template
    ::twt::simulation::setup::tilburg_template_from_spec    
    # TODO: click the ready_p link for the templates

    ::twt::simulation::test::permissions_anonymous
    ::twt::simulation::test::permissions_city_admin
    ::twt::simulation::test::permissions_sim_admin
    ::twt::simulation::test::permissions_template_author
    ::twt::simulation::test::permissions_case_author
    ::twt::simulation::test::permissions_service_admin
    ::twt::simulation::test::permissions_actor

} result] } {
    global errorInfo

    # Output error stack trace and HTML response body
    ::twt::log $result
    ::twt::log "*** Tcl TRACE ***"
    ::twt::log $errorInfo
    ::twt::log "The response body is: [response body]"

    error "Test failed: $result"
}
